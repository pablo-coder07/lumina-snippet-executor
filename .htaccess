# .htaccess para Render - VERSION COMPATIBLE

# Habilitar rewrite engine
RewriteEngine On

# CORS para permitir requests desde lumina.market
Header always set Access-Control-Allow-Origin "https://lumina.market"
Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, X-API-Key, X-Request-ID"

# Manejar preflight requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Configuración PHP básica (solo las permitidas en .htaccess)
php_value memory_limit 256M
php_value max_execution_time 300
php_value upload_max_filesize 10M
php_value post_max_size 10M

# Proteger directorio snippets
<Directory "/var/www/html/snippets">
    Options -Indexes
    AllowOverride None
    Require all denied
</Directory>

# Permitir acceso a archivos específicos
<Files "health.php">
    Require all granted
</Files>

<Files "save-snippet.php">
    Require all granted
</Files>

<Files "execute-snippet.php">
    Require all granted
</Files>

<Files "index.php">
    Require all granted
</Files>

# Denegar acceso a otros archivos PHP por defecto
<Files "*.php">
    Require all denied
</Files>

# Logs de errores
php_flag log_errors on
